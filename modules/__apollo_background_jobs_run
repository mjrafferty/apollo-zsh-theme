# vim:ft=zsh
#
################################################################
# Segment to indicate background jobs with an icon.

typeset -g APOLLO_BACKGROUND_JOBS_VERBOSE="true"
typeset -g APOLLO_BACKGROUND_JOBS_VERBOSE_ALWAYS="true"

__apollo_background_jobs_cache_key() {
  __APOLLO_RETURN_MESSAGE="1"
}

__apollo_background_jobs_run() {

  local msg

  if [[ $APOLLO_BACKGROUND_JOBS_VERBOSE == true ]]; then
    if [[ $APOLLO_BACKGROUND_JOBS_VERBOSE_ALWAYS == true ]]; then
      msg='${(%):-%j}'
    else
      msg='${${(%):-%j}:#1}'
    fi
  fi

  __APOLLO_RETURN_MESSAGE="${msg}"

}

__apollo_background_jobs_run "$@"
